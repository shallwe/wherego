# coding: utf-8
import json
import os
import random
from pprint import pprint


def parse_cities(province):
    data = json.load(open("data/{}.json".format(province)))
    ret = {}
    for city in data['features']:
        name = city['properties']['name']
        if '市' == name[-1]:
            name = name[:-1]
        ret[name] = city['properties']['cp']
    return ret


def make_china_map():
    data = {}
    province_name_map = {
        "anhui": "安徽",
        "fujian": "福建",
        "gansu": "甘肃",
        "guangdong": "广东",
        "guangxi": "广西",
        "guizhou": "贵州",
        "hainan": "海南",
        "hebei": "河北",
        "heilongjiang": "黑龙江",
        "henan": "河南",
        "hubei": "湖北",
        "hunan": "湖南",
        "jiangsu": "江苏",
        "jiangxi": "江西",
        "jilin": "吉林",
        "liaoning": "辽宁",
        "neimenggu": "内蒙古",
        "ningxia": "宁夏",
        "qinghai": "青海",
        "shandong": "山东",
        "shanxi": "山西",
        "shanxi1": "陕西",
        "sichuan": "四川",
        "xinjiang": "新疆",
        "xizang": "西藏",
        "yunnan": "云南",
        "zhejiang": "浙江",
    }

    for f in os.listdir('data'):
        province = f[:-5]
        cities = parse_cities(province)
        for city, pos in cities.items():
            data[city] = {
                'pos': pos,
                'pr': province_name_map[province]
            }

    extra = {
        '上海': [
            121.472644,
            31.231706
        ],

        '北京': [
            116.405285,
            39.904989
        ],

        '天津': [
            117.190182,
            39.125596
        ],

        '重庆': [
            106.504962,
            29.533155
        ],

        '香港': [
            114.173355,
            22.320048
        ],

        '澳门': [
            113.54909,
            22.198951
        ]
    }
    for city, pos in extra.items():
        data[city] = {
            "pr": city,
            "pos": pos
        }
    taiwan = {
            "台北": [121.5, 25.05],
            "高雄": [120.37, 22.64],
            "基隆": [121.73, 25.14],
            "台中": [120.67, 24.15],
            "台南": [120.19, 22.98],
            "宜兰": [121.75, 24.75],
            "桃园": [121.3, 25],
            "新竹": [120.96, 24.81],
    }
    for city, pos in taiwan.items():
        data[city] = {
            "pr": '台湾',
            "pos": pos
        }
    json.dump(data, open('../app/static/json/china_city.json', 'w'))
    from pprint import pprint
    pprint(data)

def make_old_city():

    old_cities = {
        "武汉": {"pr": "湖北", "pos": [114.298572, 30.584355]},
        "漳州": {"pr": "福建", "pos": [117.661801, 24.510897]},
        "遵义": {"pr": "贵州", "pos": [106.937265, 27.706626]},
        "南昌": {"pr": "江西", "pos": [115.892151, 28.676493]},
        "丽江": {"pr": "云南", "pos": [100.233026, 26.872108]},
        "洛阳": {"pr": "河南", "pos": [112.434468, 34.663041]},
        "北京": {"pr": "北京", "pos": [116.405285, 39.904989]},
        "湖州": {"pr": "浙江", "pos": [120.102398, 30.867198]},
        "天水": {"pr": "甘肃", "pos": [105.724998, 34.578529]},
        "青岛": {"pr": "山东", "pos": [120.355173, 36.082982]},
        "岳阳": {"pr": "湖南", "pos": [113.132855, 29.37029]},
        "乐山": {"pr": "四川", "pos": [103.761263, 29.582024]},
        "泰安": {"pr": "山东", "pos": [117.129063, 36.194968]},
        "哈尔滨": {"pr": "黑龙江", "pos": [126.642464, 45.756967]},
        "延安": {"pr": "陕西", "pos": [109.49081, 36.596537]},
        "开封": {"pr": "河南", "pos": [114.341447, 34.797049]},
        "银川": {"pr": "宁夏", "pos": [106.278179, 38.46637]},
        "太原": {"pr": "山西", "pos": [112.549248, 37.857014]},
        "随州": {"pr": "湖北", "pos": [113.37377, 31.717497]},
        "桂林": {"pr": "广西", "pos": [110.299121, 25.274215]},
        "柳州": {"pr": "广西", "pos": [109.411703, 24.314617]},
        "重庆": {"pr": "重庆", "pos": [106.504962, 29.533155]},
        "榆林": {"pr": "陕西", "pos": [109.741193, 38.290162]},
        "宁波": {"pr": "浙江", "pos": [121.549792, 29.868388]},
        "自贡": {"pr": "四川", "pos": [104.773447, 29.352765]},
        "上海": {"pr": "上海", "pos": [121.472644, 31.231706]},
        "佛山": {"pr": "广东", "pos": [113.122717, 23.028762]},
        "咸阳": {"pr": "陕西", "pos": [108.705117, 34.333439]},
        "广州": {"pr": "广东", "pos": [113.280637, 23.125178]},
        "拉萨": {"pr": "西藏", "pos": [91.132212, 29.660361]},
        "商丘": {"pr": "河南", "pos": [115.650497, 34.437054]},
        "宜宾": {"pr": "四川", "pos": [104.630825, 28.760189]},
        "景德镇": {"pr": "江西", "pos": [117.214664, 29.29256]},
        "肇庆": {"pr": "广东", "pos": [112.472529, 23.051546]},
        "张掖": {"pr": "甘肃", "pos": [100.455472, 38.932897]},
        "汉中": {"pr": "陕西", "pos": [107.028621, 33.077668]},
        "镇江": {"pr": "江苏", "pos": [119.452753, 32.204402]},
        "福州": {"pr": "福建", "pos": [119.306239, 26.075302]},
        "杭州": {"pr": "浙江", "pos": [120.153576, 30.287459]},
        "南阳": {"pr": "河南", "pos": [112.540918, 32.999082]},
        "武威": {"pr": "甘肃", "pos": [102.634697, 37.929996]},
        "安庆": {"pr": "安徽", "pos": [117.043551, 30.50883]},
        "苏州": {"pr": "江苏", "pos": [120.619585, 31.299379]},
        "濮阳": {"pr": "河南", "pos": [115.041299, 35.768234]},
        "金华": {"pr": "浙江", "pos": [119.649506, 29.089524]},
        "泰州": {"pr": "江苏", "pos": [119.915176, 32.484882]},
        "天津": {"pr": "天津", "pos": [117.190182, 39.125596]},
        "昆明": {"pr": "云南", "pos": [102.712251, 25.040609]},
        "扬州": {"pr": "江苏", "pos": [119.421003, 32.393159]},
        "聊城": {"pr": "山东", "pos": [115.980367, 36.456013]},
        "吉林": {"pr": "吉林", "pos": [126.55302, 43.843577]},
        "梅州": {"pr": "广东", "pos": [116.117582, 24.299112]},
        "常州": {"pr": "江苏", "pos": [119.946973, 31.772752]},
        "惠州": {"pr": "广东", "pos": [114.412599, 23.079404]},
        "邯郸": {"pr": "河北", "pos": [114.490686, 36.612273]},
        "南通": {"pr": "江苏", "pos": [120.864608, 32.016212]},
        "淮安": {"pr": "江苏", "pos": [119.021265, 33.597506]},
        "绍兴": {"pr": "浙江", "pos": [120.582112, 29.997117]},
        "赣州": {"pr": "江西", "pos": [114.940278, 25.85097]},
        "衢州": {"pr": "浙江", "pos": [118.87263, 28.941708]},
        "无锡": {"pr": "江苏", "pos": [120.301663, 31.574729]},
        "烟台": {"pr": "山东", "pos": [121.391382, 37.539297]},
        "嘉兴": {"pr": "浙江", "pos": [120.750865, 30.762653]},
        "成都": {"pr": "四川", "pos": [104.065735, 30.659462]},
        "保定": {"pr": "河北", "pos": [115.482331, 38.867657]},
        "齐齐哈尔": {"pr": "黑龙江", "pos": [123.95792, 47.342081]},
        "北海": {"pr": "广西", "pos": [109.119254, 21.473343]},
        "济南": {"pr": "山东", "pos": [117.000923, 36.675807]},
        "潮州": {"pr": "广东", "pos": [116.632301, 23.661701]},
        "日喀则": {"pr": "西藏", "pos": [88.885148, 29.267519]},
        "泉州": {"pr": "福建", "pos": [118.589421, 24.908853]},
        "海口": {"pr": "海南", "pos": [110.33119, 20.031971]},
        "徐州": {"pr": "江苏", "pos": [117.184811, 34.261792]},
        "郑州": {"pr": "河南", "pos": [113.665412, 34.757975]},
        "呼和浩特": {"pr": "内蒙古", "pos": [111.670801, 40.818311]},
        "温州": {"pr": "浙江", "pos": [120.672111, 28.000575]},
        "南京": {"pr": "江苏", "pos": [118.767413, 32.041544]},
        "泸州": {"pr": "四川", "pos": [105.443348, 28.889138]},
        "安阳": {"pr": "河南", "pos": [114.352482, 36.103442]},
        "沈阳": {"pr": "辽宁", "pos": [123.429096, 41.796767]},
        "长沙": {"pr": "湖南", "pos": [112.982279, 28.19409]},
        "亳州": {"pr": "安徽", "pos": [115.782939, 33.869338]},
        "阆中": {"pos": [106.078093, 31.602117], "pr": "四川"},
        "喀什市": {"pos": [76.014343, 39.513111], "pr": "新疆"},
        "吐鲁番": {"pos": [89.266025, 42.678925], "pr": "新疆"},
        "承德市": {"pos": [117.933822, 40.992521], "pr": "河北"},
        "库车县": {"pos": [83.459807, 41.781933], "pr": "新疆"},
        "宜兴": {"pos": [119.790265, 31.362245], "pr": "江苏"},
        "凤凰县": {"pos": [109.518882, 28.013633], "pr": "湖南"},
        "瑞金": {"pos": [115.985867, 25.921831], "pr": "江西"},
        "都江堰": {"pos": [103.637342, 31.039124], "pr": "四川"},
        "常熟": {"pos": [120.831486, 31.669446], "pr": "江苏"},
        "镇远": {"pos": [108.475888, 27.12163], "pr": "贵州"},
        "西安市": {"pos": [108.953098, 34.2778], "pr": "陕西"},
        "建水": {"pos": [102.889674, 23.683914], "pr": "云南"},
        "祁县": {"pos": [112.469066, 37.292198], "pr": "河南"},
        "曲阜": {"pos": [117.03179, 35.615761], "pr": "山东"},
        "琼山": {"pos": [110.48011, 19.741334], "pr": "海南"},
        "会泽县": {"pos": [103.468544, 26.462218], "pr": "云南"},
        "中山市": {"pos": [113.42206, 22.545178], "pr": "广东"},
        "青州": {"pos": [118.470187, 36.680584], "pr": "山东"},
        "雷州": {"pos": [110.012636, 20.796584], "pr": "广东"},
        "代县": {"pos": [113.050582, 39.093197], "pr": "山西"},
        "钟祥": {"pos": [112.584826, 31.244981], "pr": "湖北"},
        "大理市": {"pos": [100.219209, 25.693967], "pr": "云南"},
        "蓬莱": {"pos": [120.862694, 37.66116], "pr": "山东"},
        "平遥": {"pos": [112.265493, 37.14809], "pr": "山西"},
        "大同市": {"pos": [113.290509, 40.113744], "pr": "山西"},
        "绩溪县": {"pos": [118.663777, 30.162401], "pr": "安徽"},
        "特克斯县": {"pos": [82.006852, 42.925564], "pr": "新疆"},
        "山海关区": {"pos": [119.713616, 40.0329], "pr": "河北"},
        "江孜": {"pos": [89.66905, 28.91068], "pr": "西藏"},
        "江陵": {"pos": [112.473701, 30.101503], "pr": "湖北"},
        "巍山": {"pos": [100.178639, 25.246753], "pr": "云南"},
        "敦煌": {"pos": [94.158042, 40.388771], "pr": "甘肃"},
        "正定": {"pos": [114.570201, 38.227073], "pr": "河北"},
        "伊宁": {"pos": [81.289048, 44.020356], "pr": "新疆"},
        "同仁": {"pos": [102.078449, 35.426829], "pr": "青海"},
        "邹城": {"pos": [117.089582, 35.354043], "pr": "山东"},
        "临淄": {"pos": [118.300697, 36.854244], "pr": "山东"},
        "会理县": {"pos": [102.263927, 26.591301], "pr": "四川"},
        "歙县": {"pos": [118.575156, 29.871177], "pr": "安徽"},
        "新绛": {"pos": [111.172875, 35.631583], "pr": "山西"},
        "临海": {"pos": [121.221919, 28.857389], "pr": "浙江"},
        "浚县": {"pos": [114.467186, 35.686206], "pr": "河南"},
        "寿县": {"pos": [116.768939, 32.262396], "pr": "安徽"},
        "襄樊": {"pos": [112.176326, 32.094934], "pr": "湖北"},
        "长汀": {"pos": [116.371884, 25.696958], "pr": "福建"},
        "韩城": {"pos": [110.393774, 35.582782], "pr": "陕西"},
        "集安": {"pos": [125.998992, 41.251411], "pr": "吉林"},
    }

    json.dump(old_cities, open('../app/static/json/old_city.json', 'w'))

def make_unusual_city():
    unusual_city = {
        "潮州": {"pos": [116.630076, 23.661812], "pr": "广东"},
        "恩施市": {"pos": [109.517433, 30.308979], "pr": "湖北"},
        "承德市": {"pos": [117.933822, 40.992521], "pr": "河北"},
        "东川": {"pos": [103.078562, 26.139329], "pr": "云南"},
        "丹东": {"pos": [124.338543, 40.129023], "pr": "辽宁"},
        "赣州": {"pos": [114.935909, 25.845296], "pr": "江西"},
        "广元": {"pos": [105.819687, 32.44104], "pr": "四川"},
        "蓟县": {"pos": [117.441159, 40.009614], "pr": "天津"},
        "靖江": {"pos": [120.276899, 32.039443], "pr": "江苏"},
        "临海": {"pos": [121.221919, 28.857389], "pr": "浙江"},
        "泉州": {"pos": [118.600362, 24.901652], "pr": "福建"},
        "日照": {"pos": [119.50718, 35.420225], "pr": "山东"},
        "漠河": {"pos": [122.715721, 52.945659], "pr": "黑龙江"},
        "三门峡": {"pos": [111.181262, 34.78332], "pr": "河南"},
        "汕头": {"pos": [116.72865, 23.383908], "pr": "广东"},
        "上饶": {"pos": [117.955464, 28.457623], "pr": "江西"},
        "寿县": {"pos": [116.768939, 32.262396], "pr": "安徽"},
        "台州": {"pos": [121.440613, 28.668283], "pr": "浙江"},
        "天水": {"pos": [105.736932, 34.584319], "pr": "甘肃"},
        "威海": {"pos": [122.093958, 37.528787], "pr": "山东"},
        "黔东南": {"pos": [107.985353, 26.583992], "pr": "贵州"},
        "兴化": {"pos": [119.996418, 32.961954], "pr": "江苏"},
        "兴城": {"pos": [120.475527, 40.596284], "pr": "辽宁"},
        "烟台": {"pos": [121.309555, 37.536562], "pr": "山东"},
        "伊宁县": {"pos": [81.75694, 44.008117], "pr": "新疆"},
        "宜宾": {"pos": [104.633019, 28.769675], "pr": "四川"},
        "元阳": {"pos": [102.819567, 23.069203], "pr": "云南"},
        "长汀": {"pos": [116.371884, 25.696958], "pr": "福建"},
        "镇远县": {"pos": [108.475888, 27.12163], "pr": "贵州"},
        "正定": {"pos": [114.570201, 38.227073], "pr": "河北"},
        "舟山": {"pos": [122.169872, 30.03601], "pr": "浙江"},
        "钟祥": {"pos": [112.584826, 31.244981], "pr": "湖北"},
    }
    json.dump(unusual_city, open('../app/static/json/unusual_city.json', 'w'))

if __name__ == '__main__':
    make_unusual_city()
